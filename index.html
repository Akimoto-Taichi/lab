<!DOCTYPE html>
</div>


<script>
// ===== userId 自動生成 =====
let userId = localStorage.getItem("userId");
if (!userId) {
userId = crypto.randomUUID();
localStorage.setItem("userId", userId);
}


const GAS_URL = "https://script.googleusercontent.com/a/macros/edu.nishiyamato.ed.jp/echo?user_content_key=AehSKLgaO9I_xX6rwUPjDPCBpevLPs_PxtJimWwxkqzP6f8M2Y7Vf0DRCHNmrsWuSR7QDcMDEL-vCfCI-MJSS59Nc5d9yyipeiWjv6DWQPB2yMHbXAcx9UruxjSGUAz3YGXSHciC5qIvV3mncmLHLqv4JW2zGtWMy5J0zH7IYhtIsE6d5yMSBgT5LEqsonN9TYLx0hojpCxQp4D2A4YyaNch54cPrPLh0i0rS12zjuLavYGd-zDVMoqWGFfEX05lCk40rkTk_o2ubm0_GaVpdFOC6w69bcxJXCHcj20ni49VYsA8lqMe5CU5EsWEOUZ0ut2ARcd0wWtk&lib=Mrn7O9PAKaoeK1wWor6WIaPXJmm3A9Qs8";
let cards = [];
let current = null;


function addCard() {
const q = document.getElementById("q").value;
const a = document.getElementById("a").value;
if (!q || !a) return;


fetch(GAS_URL, {
method: "POST",
body: JSON.stringify({ mode: "add", userId, q, a })
}).then(() => {
document.getElementById("q").value = "";
document.getElementById("a").value = "";
loadCards();
});
}


function loadCards() {
fetch(GAS_URL, {
method: "POST",
body: JSON.stringify({ mode: "get", userId })
})
.then(r => r.json())
.then(d => {
cards = d;
if (cards.length > 0) {
document.getElementById("study").style.display = "block";
nextCard();
}
});
}


function nextCard() {
current = cards[Math.floor(Math.random() * cards.length)];
document.getElementById("question").textContent = current.question;
document.getElementById("answer").style.display = "none";
}


function showAnswer() {
document.getElementById("answer").textContent = current.answer;
document.getElementById("answer").style.display = "block";
}


function judge(correct) {
fetch(GAS_URL, {
method: "POST",
body: JSON.stringify({ mode: "judge", userId, id: current.id, correct })
}).then(() => nextCard());
}


loadCards();
</script>
</body>
</html>

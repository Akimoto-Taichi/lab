<!DOCTYPE html>
</div>


<script>
// ===== userId 自動生成 =====
let userId = localStorage.getItem("userId");
if (!userId) {
userId = crypto.randomUUID();
localStorage.setItem("userId", userId);
}


const GAS_URL = "https://script.google.com/a/macros/edu.nishiyamato.ed.jp/s/AKfycbwzF4N3KWNRuBPFPNbqu0gZHZACM8r97fDgirnNoaDvmmouSl1cbJPEozOc_WdItloIVg/exec";
let cards = [];
let current = null;


function addCard() {
const q = document.getElementById("q").value;
const a = document.getElementById("a").value;
if (!q || !a) return;


fetch(GAS_URL, {
method: "POST",
body: JSON.stringify({ mode: "add", userId, q, a })
}).then(() => {
document.getElementById("q").value = "";
document.getElementById("a").value = "";
loadCards();
});
}


function loadCards() {
fetch(GAS_URL, {
method: "POST",
body: JSON.stringify({ mode: "get", userId })
})
.then(r => r.json())
.then(d => {
cards = d;
if (cards.length > 0) {
document.getElementById("study").style.display = "block";
nextCard();
}
});
}


function nextCard() {
current = cards[Math.floor(Math.random() * cards.length)];
document.getElementById("question").textContent = current.question;
document.getElementById("answer").style.display = "none";
}


function showAnswer() {
document.getElementById("answer").textContent = current.answer;
document.getElementById("answer").style.display = "block";
}


function judge(correct) {
fetch(GAS_URL, {
method: "POST",
body: JSON.stringify({ mode: "judge", userId, id: current.id, correct })
}).then(() => nextCard());
}


loadCards();
</script>
</body>
</html>
